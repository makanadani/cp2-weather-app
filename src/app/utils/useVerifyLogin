"use client";

import { useContext, useEffect } from "react";
import { jwtDecode } from "jwt-decode";
import UserContext from "../context/UserContext";

interface CustomJwtPayload {
  name: string;
}

export const useVerifyLogin = () => {
  const { setUserName } = useContext(UserContext);

  useEffect(() => {
    const sessionData = sessionStorage.getItem("userToken");
    if (sessionData) {
      try {
        const userData = jwtDecode<CustomJwtPayload>(JSON.parse(sessionData).token);
        setUserName(userData.name);
      } catch (error) {
        console.error("Erro ao decodificar o token:", error);
      }
    }
  }, [setUserName]);
};
